
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Reshaping Data From Wide to Long Form &#8212; Data Wrangling Recipes</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "samukweku/data-wrangling");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "ðŸ’¬ comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Data Wrangling Recipes</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Data Wrangling Recipes
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="datatable.html">
   Data Wrangling with Python Datatable
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="python_datatable_column_selection.html">
     Column Selection in Datatable
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="python_datatable_row_selection.html">
     Filtering Rows in Datatable
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="replicate_SD_datatable.html">
     Replicating .SD in Python Datatable
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="python_datatable_vs_R_datatable.html">
     Python datatable vs R data.table comparison
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="pandas.html">
   Data Wrangling with Pandas
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="python_pandas_column_selection.html">
     Column Selection in Pandas - and Pyjanitor
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="python_pandas_row_selection.html">
     Filtering Rows in Pandas
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/python_datatable_wide_to_long.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/samukweku/samukweku.github.io/data-wrangling"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/samukweku/samukweku.github.io/data-wrangling/issues/new?title=Issue%20on%20page%20%2Fpython_datatable_wide_to_long.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/samukweku/samukweku.github.io/master?urlpath=tree/docs/python_datatable_wide_to_long.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#selecting-columns">
   <strong>
    Selecting Columns
   </strong>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-basics">
     The Basics
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Reshaping Data From Wide to Long Form</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#selecting-columns">
   <strong>
    Selecting Columns
   </strong>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-basics">
     The Basics
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="reshaping-data-from-wide-to-long-form">
<h1>Reshaping Data From Wide to Long Form<a class="headerlink" href="#reshaping-data-from-wide-to-long-form" title="Permalink to this headline">Â¶</a></h1>
<p>This article highlights various ways to reshape data from wide to long form in python <a class="reference external" href="https://datatable.readthedocs.io/en/latest/">datatable</a>.</p>
<div class="section" id="selecting-columns">
<h2><strong>Selecting Columns</strong><a class="headerlink" href="#selecting-columns" title="Permalink to this headline">Â¶</a></h2>
<div class="section" id="the-basics">
<h3>The Basics<a class="headerlink" href="#the-basics" title="Permalink to this headline">Â¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datatable</span> <span class="kn">import</span> <span class="n">dt</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">Type</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Pattern</span><span class="p">,</span> <span class="n">NamedTuple</span><span class="p">,</span> <span class="n">Union</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span><span class="p">,</span> <span class="n">defaultdict</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">compress</span><span class="p">,</span> <span class="n">chain</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type='text/css'>
.datatable table.frame { margin-bottom: 0; }
.datatable table.frame thead { border-bottom: none; }
.datatable table.frame tr.coltypes td {  color: #FFFFFF;  line-height: 6px;  padding: 0 0.5em;}
.datatable .bool    { background: #DDDD99; }
.datatable .object  { background: #565656; }
.datatable .int     { background: #5D9E5D; }
.datatable .float   { background: #4040CC; }
.datatable .str     { background: #CC4040; }
.datatable .time    { background: #40CC40; }
.datatable .row_index {  background: var(--jp-border-color3);  border-right: 1px solid var(--jp-border-color0);  color: var(--jp-ui-font-color3);  font-size: 9px;}
.datatable .frame tbody td { text-align: left; }
.datatable .frame tr.coltypes .row_index {  background: var(--jp-border-color0);}
.datatable th:nth-child(2) { padding-left: 12px; }
.datatable .hellipsis {  color: var(--jp-cell-editor-border-color);}
.datatable .vellipsis {  background: var(--jp-layout-color0);  color: var(--jp-cell-editor-border-color);}
.datatable .na {  color: var(--jp-cell-editor-border-color);  font-size: 80%;}
.datatable .sp {  opacity: 0.25;}
.datatable .footer { font-size: 9px; }
.datatable .frame_dimensions {  background: var(--jp-border-color3);  border-top: 1px solid var(--jp-border-color0);  color: var(--jp-ui-font-color3);  display: inline-block;  opacity: 0.6;  padding: 1px 10px 1px 5px;}
</style>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datatable</span> <span class="kn">import</span> <span class="n">dt</span><span class="p">,</span> <span class="n">f</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Pattern</span><span class="p">,</span> <span class="n">NamedTuple</span><span class="p">,</span> <span class="n">Union</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span><span class="p">,</span> <span class="n">defaultdict</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">compress</span><span class="p">,</span> <span class="n">chain</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">class</span> <span class="nc">measure</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;tuple for more complex reshape.&quot;&quot;&quot;</span>
    <span class="n">column_names</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">]</span>
    <span class="n">sep</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Pattern</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">pattern</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Pattern</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">def</span> <span class="nf">melt</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">measure_vars</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">variable_name</span> <span class="o">=</span> <span class="s1">&#39;variable&#39;</span><span class="p">,</span> <span class="n">value_name</span> <span class="o">=</span> <span class="s1">&#39;value&#39;</span><span class="p">):</span>
    <span class="s2">&quot;Turns Frame from wide to long form.&quot;</span>
    <span class="k">if</span> <span class="n">id_vars</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">id_vars</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;id_vars should be one of str, list, tuple.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">id_vars</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">id_vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">id_vars</span><span class="p">]</span>
        <span class="n">checks</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">id_vars</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">checks</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Labels </span><span class="si">{</span><span class="n">checks</span><span class="si">}</span><span class="s1"> in id_vars do not exist in the column names.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">names</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">id_vars</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">data</span>
        <span class="n">checks</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="n">Counter</span><span class="p">(</span><span class="n">id_vars</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">checks</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Labels </span><span class="si">{</span><span class="n">checks</span><span class="si">}</span><span class="s2"> are duplicated in id_vars.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">measure_vars</span><span class="p">:</span>
            <span class="n">measure_vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">names</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">id_vars</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">measure_vars</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">measure_vars</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;measure_vars should be one of str, list, tuple.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">measure_vars</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">measure_vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">measure_vars</span><span class="p">]</span>
        <span class="n">checks</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">measure_vars</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">checks</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Labels </span><span class="si">{</span><span class="n">checks</span><span class="si">}</span><span class="s1"> in measure_vars do not exist in the column names.&#39;</span><span class="p">)</span>
        <span class="n">checks</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="n">Counter</span><span class="p">(</span><span class="n">measure_vars</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">checks</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Labels </span><span class="si">{</span><span class="n">checks</span><span class="si">}</span><span class="s2"> are duplicated in measure_vars.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">id_vars</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">measure_vars</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">data</span><span class="o">.</span><span class="n">ncols</span><span class="p">):</span>
            <span class="n">id_vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">names</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">measure_vars</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">measure_vars</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">names</span>

    <span class="k">def</span> <span class="nf">reshape_no_dot</span><span class="p">(</span><span class="n">measure_vars</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">measure_vars</span><span class="p">]:</span>
            <span class="n">frame</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">value_name</span><span class="p">]</span>
            <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">id_vars</span><span class="p">:</span>
            <span class="n">id_vars</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="n">id_vars</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">measure_vars</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">dt</span><span class="o">.</span><span class="n">cbind</span><span class="p">([</span><span class="n">id_vars</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">values</span><span class="p">],</span> <span class="n">force</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dt</span><span class="o">.</span><span class="n">cbind</span><span class="p">([</span><span class="n">output</span><span class="p">,</span> <span class="n">values</span><span class="p">],</span> <span class="n">force</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">reshape_dot</span><span class="p">(</span><span class="n">column_names</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">measure_vars</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="s2">&quot;reshape if &#39;.value&#39; is present in the column names.&quot;</span>
        <span class="n">boolean</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span> <span class="k">if</span> <span class="n">ent</span> <span class="o">==</span> <span class="s1">&#39;.value&#39;</span> <span class="k">else</span> <span class="kc">False</span> <span class="k">for</span> <span class="n">ent</span> <span class="ow">in</span> <span class="n">column_names</span><span class="p">]</span>
        <span class="n">dot_value</span> <span class="o">=</span> <span class="p">[[</span><span class="o">*</span><span class="n">compress</span><span class="p">(</span><span class="n">extract</span><span class="p">,</span> <span class="n">boolean</span><span class="p">)]</span> <span class="k">for</span> <span class="n">extract</span> <span class="ow">in</span> <span class="n">output</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dot_value</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">dot_value</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">extract</span><span class="p">)</span> <span class="k">for</span> <span class="n">extract</span> <span class="ow">in</span> <span class="n">dot_value</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dot_value</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">dot_value</span><span class="p">)]</span>
        <span class="n">checks</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">dot_value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">id_vars</span> <span class="ow">and</span> <span class="n">checks</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">id_vars</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The new column names associated with .value -&gt; </span><span class="si">{</span><span class="n">checks</span><span class="si">}</span><span class="s2"> &quot;</span>
                <span class="s2">&quot;are duplicated in id_vars.&quot;</span>
            <span class="p">)</span>
        <span class="n">boolean</span> <span class="o">=</span> <span class="p">[</span><span class="ow">not</span> <span class="n">true</span> <span class="k">for</span> <span class="n">true</span> <span class="ow">in</span> <span class="n">boolean</span><span class="p">]</span>
        <span class="n">others</span> <span class="o">=</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="n">extract</span><span class="p">,</span> <span class="n">boolean</span><span class="p">))</span> <span class="k">for</span> <span class="n">extract</span> <span class="ow">in</span> <span class="n">output</span><span class="p">]</span>
        <span class="n">headers_for_others</span> <span class="o">=</span> <span class="p">[</span><span class="n">extract</span> <span class="k">for</span> <span class="n">extract</span> <span class="ow">in</span> <span class="n">column_names</span> <span class="k">if</span> <span class="n">extract</span> <span class="o">!=</span> <span class="s1">&#39;.value&#39;</span><span class="p">]</span>
        <span class="n">measure_vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">frame</span> <span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">measure_vars</span><span class="p">]]</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value_column</span><span class="p">,</span> <span class="n">frame</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">others</span><span class="p">,</span> <span class="n">dot_value</span><span class="p">,</span> <span class="n">measure_vars</span><span class="p">):</span>
            <span class="n">frame</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">value_column</span><span class="p">]</span>
            <span class="n">out</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
        <span class="n">headers_for_others</span> <span class="o">=</span> <span class="p">[</span><span class="n">dt</span><span class="o">.</span><span class="n">Frame</span><span class="p">([</span><span class="n">key</span><span class="p">],</span> <span class="n">names</span> <span class="o">=</span> <span class="n">headers_for_others</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">out</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
        <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="n">dt</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">force</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">out</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
        <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="n">dt</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="o">.</span><span class="n">nrows</span><span class="p">),</span> <span class="n">right</span><span class="p">,</span> <span class="n">force</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">headers_for_others</span><span class="p">,</span> <span class="n">out</span><span class="p">)]</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">force</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">id_vars</span><span class="p">:</span>
            <span class="n">id_vars</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="n">id_vars</span><span class="p">],</span> <span class="n">out</span><span class="o">.</span><span class="n">nrows</span><span class="o">//</span><span class="n">data</span><span class="o">.</span><span class="n">nrows</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">dt</span><span class="o">.</span><span class="n">cbind</span><span class="p">([</span><span class="n">id_vars</span><span class="p">,</span> <span class="n">out</span><span class="p">],</span> <span class="n">force</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">variable_name</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">Pattern</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;variable_name should be one of string, tuple, dictionary, regular expression.&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">variable_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;value_name should be a string.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value_name</span> <span class="o">==</span> <span class="n">variable_name</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value_name</span><span class="si">}</span><span class="s2"> is duplicated as variable_name. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Kindly provide a unique argument for </span><span class="si">{</span><span class="n">value_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">id_vars</span><span class="p">:</span> 
            <span class="k">if</span> <span class="n">variable_name</span> <span class="ow">in</span> <span class="n">id_vars</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">variable_name</span><span class="si">}</span><span class="s2"> already exists as a label &quot;</span>
                    <span class="s2">&quot;in id_vars. Kindly provide a unique argument.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">value_name</span> <span class="ow">in</span> <span class="n">id_vars</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value_name</span><span class="si">}</span><span class="s2"> already exists as a label &quot;</span>
                    <span class="s2">&quot;in id_vars. Kindly provide a unique argument.&quot;</span><span class="p">)</span>

        <span class="n">output</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">Frame</span><span class="p">({</span><span class="n">variable_name</span><span class="p">:</span><span class="n">measure_vars</span><span class="p">})</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">nrows</span><span class="p">),</span> <span class="n">data</span><span class="o">.</span><span class="n">nrows</span><span class="p">),:]</span>
        <span class="k">return</span> <span class="n">reshape_no_dot</span><span class="p">(</span><span class="n">measure_vars</span><span class="o">=</span><span class="n">measure_vars</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span> <span class="n">id_vars</span> <span class="o">=</span> <span class="n">id_vars</span><span class="p">)</span>


    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">variable_name</span><span class="p">,</span> <span class="n">Pattern</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">variable_name</span><span class="p">)</span><span class="o">.</span><span class="n">groups</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The regex should have at least one group.&quot;</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">variable_name</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">measure_vars</span><span class="p">]</span>
        <span class="n">no_matches</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span> <span class="k">for</span> <span class="n">word</span><span class="p">,</span> <span class="n">match</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">measure_vars</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">no_matches</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;There was no match for labels </span><span class="si">{</span><span class="n">no_matches</span><span class="si">}</span><span class="s2"> &quot;</span>
                <span class="s2">&quot;for the provided regular expression.&quot;</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="n">entry</span><span class="o">.</span><span class="n">groupdict</span><span class="p">()</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">output</span><span class="p">]</span>
        <span class="n">checks</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">id_vars</span> <span class="ow">and</span> <span class="nb">set</span><span class="p">(</span><span class="n">checks</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">id_vars</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Labels </span><span class="si">{</span><span class="n">checks</span><span class="si">}</span><span class="s2"> already exist in id_vars. &quot;</span>
                <span class="s2">&quot;Kindly provide unique names for the named groups &quot;</span> 
                <span class="s2">&quot;in the regular expression.&quot;</span>
                <span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">nrows</span><span class="p">),</span> <span class="n">data</span><span class="o">.</span><span class="n">nrows</span><span class="p">),:]</span>        
        <span class="k">return</span> <span class="n">reshape_no_dot</span><span class="p">(</span><span class="n">measure_vars</span><span class="o">=</span><span class="n">measure_vars</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span> <span class="n">id_vars</span> <span class="o">=</span> <span class="n">id_vars</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">variable_name</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="p">:</span>
        <span class="n">checks</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">variable_name</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">id_vars</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">id_vars</span> <span class="ow">and</span> <span class="n">checks</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Labels </span><span class="si">{</span><span class="n">checks</span><span class="si">}</span><span class="s2"> already exist in id_vars. &quot;</span>
                <span class="s2">&quot;Kindly provide keys for the dictionary &quot;</span>
                <span class="s2">&quot;that do not exist in id_vars.&quot;</span>
                <span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">regex</span> <span class="ow">in</span> <span class="n">variable_name</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> should be a string.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">regex</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Pattern</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;The value for </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> should be a regular expression, &quot;</span>
                    <span class="s2">&quot;or can be compiled into one.&quot;</span>
                    <span class="p">)</span>
            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">regex</span><span class="p">)</span><span class="o">.</span><span class="n">groups</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The regex should not have any groups.&quot;</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">regex</span> <span class="ow">in</span> <span class="n">variable_name</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">measure_vars</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">regex</span><span class="p">,</span> <span class="n">word</span><span class="p">)]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">out</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;There was no match for </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> for regex =&gt; </span><span class="si">{</span><span class="n">regex</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>            
            
            <span class="n">measure_vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">measure_vars</span> <span class="k">if</span> <span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">out</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">frame</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">out</span><span class="p">]:</span>
                    <span class="n">frame</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span><span class="p">]</span>
                    <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
                <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">rbind</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">force</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">cbind</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">id_vars</span><span class="p">:</span>
            <span class="n">id_vars</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="n">id_vars</span><span class="p">],</span> <span class="n">output</span><span class="o">.</span><span class="n">nrows</span><span class="o">//</span><span class="n">data</span><span class="o">.</span><span class="n">nrows</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">dt</span><span class="o">.</span><span class="n">cbind</span><span class="p">([</span><span class="n">id_vars</span><span class="p">,</span> <span class="n">output</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">output</span>
          
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">variable_name</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="n">variable_name</span> <span class="o">=</span> <span class="n">measure</span><span class="p">(</span><span class="o">*</span><span class="n">variable_name</span><span class="p">)</span>
        <span class="n">column_names</span><span class="p">,</span> <span class="n">sep</span><span class="p">,</span> <span class="n">pattern</span> <span class="o">=</span> <span class="n">variable_name</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">column_names</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Kindly provide argument for column_names, in the variable_name tuple.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column_names</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;column_names should be one of string, list.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">column_names</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">column_names</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">id_vars</span><span class="p">:</span>
            <span class="n">checks</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">column_names</span><span class="p">)</span>
            <span class="n">checks</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="s2">&quot;.value&quot;</span><span class="p">)</span>
            <span class="n">checks</span> <span class="o">=</span> <span class="n">checks</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">id_vars</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">checks</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Labels </span><span class="si">{</span><span class="n">checks</span><span class="si">}</span><span class="s2"> already exist in id_vars. &quot;</span>
                    <span class="s2">&quot;Kindly provide unique column_names &quot;</span>
                    <span class="s2">&quot;that do not exist in id_vars.&quot;</span>
                    <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">((</span><span class="n">sep</span><span class="p">,</span> <span class="n">pattern</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Kindly provide one of sep or pattern.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sep</span> <span class="ow">and</span> <span class="n">pattern</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;only one of sep or pattern should be provided.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sep</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sep</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Pattern</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="s2">&quot;sep should be a regular expression, &quot;</span>
                    <span class="s2">&quot;or can be compiled into one.&quot;</span><span class="p">)</span>
            <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">measure_vars</span><span class="p">]</span>
            <span class="n">checks</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">output</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">column_names</span><span class="p">)</span> <span class="o">!=</span> <span class="n">checks</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;The maximum number of splits for sep -&gt; </span><span class="si">{</span><span class="n">sep</span><span class="si">}</span><span class="s2"> is </span><span class="si">{</span><span class="n">checks</span><span class="si">}</span><span class="s2"> &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;while the number of labels in </span><span class="si">{</span><span class="n">column_names</span><span class="si">}</span><span class="s2"> &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;is </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">column_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;.value&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">column_names</span><span class="p">:</span>
                <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="n">output</span><span class="p">)]</span>
                <span class="n">output</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">column_names</span><span class="p">)</span>
                <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">nrows</span><span class="p">),</span> <span class="n">data</span><span class="o">.</span><span class="n">nrows</span><span class="p">),:]</span>        
                <span class="k">return</span> <span class="n">reshape_no_dot</span><span class="p">(</span><span class="n">measure_vars</span><span class="o">=</span><span class="n">measure_vars</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span> <span class="n">id_vars</span> <span class="o">=</span> <span class="n">id_vars</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">reshape_dot</span><span class="p">(</span><span class="n">column_names</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">measure_vars</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="n">id_vars</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pattern</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Pattern</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="s2">&quot;pattern should be a regular expression, &quot;</span>
                    <span class="s2">&quot;or can be compiled into one.&quot;</span><span class="p">)</span>
            <span class="n">checks</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span><span class="o">.</span><span class="n">groups</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">checks</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The regex should have at least one group.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">checks</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">column_names</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;The number of groups in the regex &quot;</span>
                    <span class="s2">&quot;should match the number of labels in column_names. &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;The number of groups in the regex is </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">checks</span><span class="p">)</span><span class="si">}</span><span class="s2">, &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;while the length of column_names is </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">column_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">measure_vars</span><span class="p">]</span>
            <span class="n">no_matches</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span> <span class="k">for</span> <span class="n">word</span><span class="p">,</span> <span class="n">match</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">measure_vars</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">no_matches</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;There was no match for labels </span><span class="si">{</span><span class="n">no_matches</span><span class="si">}</span><span class="s2"> &quot;</span>
                    <span class="s2">&quot;for the provided regular expression.&quot;</span><span class="p">)</span>
            <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">output</span><span class="p">)]</span>
            <span class="k">if</span> <span class="s1">&#39;.value&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">column_names</span><span class="p">:</span>
                <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="n">output</span><span class="p">)]</span>
                <span class="n">output</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">column_names</span><span class="p">)</span>
                <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">nrows</span><span class="p">),</span> <span class="n">data</span><span class="o">.</span><span class="n">nrows</span><span class="p">),:]</span>        
                <span class="k">return</span> <span class="n">reshape_no_dot</span><span class="p">(</span><span class="n">measure_vars</span><span class="o">=</span><span class="n">measure_vars</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="n">output</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span> <span class="n">id_vars</span> <span class="o">=</span> <span class="n">id_vars</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">reshape_dot</span><span class="p">(</span><span class="n">column_names</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">measure_vars</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="n">id_vars</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DT</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;ID&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;DateRange1Start&quot;</span><span class="p">:</span> <span class="s2">&quot;1/1/90&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;DateRange1End&quot;</span><span class="p">:</span> <span class="s2">&quot;3/1/90&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Value1&quot;</span><span class="p">:</span> <span class="mf">4.4</span><span class="p">,</span>
                    <span class="s2">&quot;DateRange2Start&quot;</span><span class="p">:</span> <span class="s2">&quot;4/5/91&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;DateRange2End&quot;</span><span class="p">:</span> <span class="s2">&quot;6/7/91&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Value2&quot;</span><span class="p">:</span> <span class="mf">6.2</span><span class="p">,</span>
                    <span class="s2">&quot;DateRange3Start&quot;</span><span class="p">:</span> <span class="s2">&quot;5/5/95&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;DateRange3End&quot;</span><span class="p">:</span> <span class="s2">&quot;6/6/96&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Value3&quot;</span><span class="p">:</span> <span class="mf">3.3</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">])</span>

<span class="n">DT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>ID</th><th>DateRange1Start</th><th>DateRange1End</th><th>Value1</th><th>DateRange2Start</th><th>DateRange2End</th><th>Value2</th><th>DateRange3Start</th><th>DateRange3End</th><th>Value3</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='int' title='int8'>&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>1</td><td>1/1/90</td><td>3/1/90</td><td>4.4</td><td>4/5/91</td><td>6/7/91</td><td>6.2</td><td>5/5/95</td><td>6/6/96</td><td>3.3</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>1 row &times; 10 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melt</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="n">variable_name</span><span class="o">=</span> <span class="p">([</span><span class="s1">&#39;.value&#39;</span><span class="p">,</span> <span class="s1">&#39;num&#39;</span><span class="p">,</span> <span class="s1">&#39;.value&#39;</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;(.+)(\d)(.*)&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>ID</th><th>num</th><th>DateRangeStart</th><th>DateRangeEnd</th><th>Value</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='int' title='int8'>&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>1</td><td>1</td><td>1/1/90</td><td>3/1/90</td><td>4.4</td></tr>
    <tr><td class='row_index'>1</td><td>1</td><td>2</td><td>4/5/91</td><td>6/7/91</td><td>6.2</td></tr>
    <tr><td class='row_index'>2</td><td>1</td><td>3</td><td>5/5/95</td><td>6/6/96</td><td>3.3</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>3 rows &times; 5 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DT</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
            <span class="s2">&quot;M_start_date_1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">201709</span><span class="p">,</span> <span class="mi">201709</span><span class="p">,</span> <span class="mi">201709</span><span class="p">],</span>
            <span class="s2">&quot;M_end_date_1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">201905</span><span class="p">,</span> <span class="mi">201905</span><span class="p">,</span> <span class="mi">201905</span><span class="p">],</span>
            <span class="s2">&quot;M_start_date_2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">202004</span><span class="p">,</span> <span class="mi">202004</span><span class="p">,</span> <span class="mi">202004</span><span class="p">],</span>
            <span class="s2">&quot;M_end_date_2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">202005</span><span class="p">,</span> <span class="mi">202005</span><span class="p">,</span> <span class="mi">202005</span><span class="p">],</span>
            <span class="s2">&quot;F_start_date_1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">201803</span><span class="p">,</span> <span class="mi">201803</span><span class="p">,</span> <span class="mi">201803</span><span class="p">],</span>
            <span class="s2">&quot;F_end_date_1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">201904</span><span class="p">,</span> <span class="mi">201904</span><span class="p">,</span> <span class="mi">201904</span><span class="p">],</span>
            <span class="s2">&quot;F_start_date_2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">201912</span><span class="p">,</span> <span class="mi">201912</span><span class="p">,</span> <span class="mi">201912</span><span class="p">],</span>
            <span class="s2">&quot;F_end_date_2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">202007</span><span class="p">,</span> <span class="mi">202007</span><span class="p">,</span> <span class="mi">202007</span><span class="p">],</span>
        <span class="p">}</span>
    <span class="p">)</span>

<span class="n">DT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>id</th><th>M_start_date_1</th><th>M_end_date_1</th><th>M_start_date_2</th><th>M_end_date_2</th><th>F_start_date_1</th><th>F_end_date_1</th><th>F_start_date_2</th><th>F_end_date_2</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>1</td><td>201709</td><td>201905</td><td>202004</td><td>202005</td><td>201803</td><td>201904</td><td>201912</td><td>202007</td></tr>
    <tr><td class='row_index'>1</td><td>2</td><td>201709</td><td>201905</td><td>202004</td><td>202005</td><td>201803</td><td>201904</td><td>201912</td><td>202007</td></tr>
    <tr><td class='row_index'>2</td><td>3</td><td>201709</td><td>201905</td><td>202004</td><td>202005</td><td>201803</td><td>201904</td><td>201912</td><td>202007</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>3 rows &times; 9 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melt</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">variable_name</span><span class="o">=</span><span class="p">([</span><span class="s2">&quot;cod&quot;</span><span class="p">,</span> <span class="s2">&quot;.value&quot;</span><span class="p">,</span> <span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="s2">&quot;num&quot;</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;(M|F)_(start|end)_(date)_(.+)&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>id</th><th>cod</th><th>date</th><th>num</th><th>start</th><th>end</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>1</td><td>M</td><td>date</td><td>1</td><td>201709</td><td>201905</td></tr>
    <tr><td class='row_index'>1</td><td>2</td><td>M</td><td>date</td><td>1</td><td>201709</td><td>201905</td></tr>
    <tr><td class='row_index'>2</td><td>3</td><td>M</td><td>date</td><td>1</td><td>201709</td><td>201905</td></tr>
    <tr><td class='row_index'>3</td><td>1</td><td>M</td><td>date</td><td>2</td><td>202004</td><td>202005</td></tr>
    <tr><td class='row_index'>4</td><td>2</td><td>M</td><td>date</td><td>2</td><td>202004</td><td>202005</td></tr>
    <tr><td class='row_index'>5</td><td>3</td><td>M</td><td>date</td><td>2</td><td>202004</td><td>202005</td></tr>
    <tr><td class='row_index'>6</td><td>1</td><td>F</td><td>date</td><td>1</td><td>201803</td><td>201904</td></tr>
    <tr><td class='row_index'>7</td><td>2</td><td>F</td><td>date</td><td>1</td><td>201803</td><td>201904</td></tr>
    <tr><td class='row_index'>8</td><td>3</td><td>F</td><td>date</td><td>1</td><td>201803</td><td>201904</td></tr>
    <tr><td class='row_index'>9</td><td>1</td><td>F</td><td>date</td><td>2</td><td>201912</td><td>202007</td></tr>
    <tr><td class='row_index'>10</td><td>2</td><td>F</td><td>date</td><td>2</td><td>201912</td><td>202007</td></tr>
    <tr><td class='row_index'>11</td><td>3</td><td>F</td><td>date</td><td>2</td><td>201912</td><td>202007</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>12 rows &times; 6 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DT</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;off_loc&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">],</span>
        <span class="s2">&quot;pt_loc&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;G&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;I&quot;</span><span class="p">,</span> <span class="s2">&quot;J&quot;</span><span class="p">,</span> <span class="s2">&quot;K&quot;</span><span class="p">,</span> <span class="s2">&quot;L&quot;</span><span class="p">],</span>
        <span class="s2">&quot;pt_lat&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="mf">100.07548220000001</span><span class="p">,</span>
            <span class="mf">75.191326</span><span class="p">,</span>
            <span class="mf">122.65134479999999</span><span class="p">,</span>
            <span class="mf">124.13553329999999</span><span class="p">,</span>
            <span class="mf">124.13553329999999</span><span class="p">,</span>
            <span class="mf">124.01028909999998</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s2">&quot;off_lat&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="mf">121.271083</span><span class="p">,</span>
            <span class="mf">75.93845266</span><span class="p">,</span>
            <span class="mf">135.043791</span><span class="p">,</span>
            <span class="mf">134.51128400000002</span><span class="p">,</span>
            <span class="mf">134.484374</span><span class="p">,</span>
            <span class="mf">137.962195</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s2">&quot;pt_long&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="mf">4.472089953</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">144.387785</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">40.45611048</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">46.07156181</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">46.07156181</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">46.01594293</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="s2">&quot;off_long&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="o">-</span><span class="mf">7.188632000000001</span><span class="p">,</span>
            <span class="o">-</span><span class="mf">143.2288569</span><span class="p">,</span>
            <span class="mf">21.242563</span><span class="p">,</span>
            <span class="mf">40.937416999999996</span><span class="p">,</span>
            <span class="mf">40.78472</span><span class="p">,</span>
            <span class="mf">22.905889000000002</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">DT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>off_loc</th><th>pt_loc</th><th>pt_lat</th><th>off_lat</th><th>pt_long</th><th>off_long</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>A</td><td>G</td><td>100.075</td><td>121.271</td><td>4.47209</td><td>&minus;7.18863</td></tr>
    <tr><td class='row_index'>1</td><td>B</td><td>H</td><td>75.1913</td><td>75.9385</td><td>&minus;144.388</td><td>&minus;143.229</td></tr>
    <tr><td class='row_index'>2</td><td>C</td><td>I</td><td>122.651</td><td>135.044</td><td>&minus;40.4561</td><td>21.2426</td></tr>
    <tr><td class='row_index'>3</td><td>D</td><td>J</td><td>124.136</td><td>134.511</td><td>&minus;46.0716</td><td>40.9374</td></tr>
    <tr><td class='row_index'>4</td><td>E</td><td>K</td><td>124.136</td><td>134.484</td><td>&minus;46.0716</td><td>40.7847</td></tr>
    <tr><td class='row_index'>5</td><td>F</td><td>L</td><td>124.01</td><td>137.962</td><td>&minus;46.0159</td><td>22.9059</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>6 rows &times; 6 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melt</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span> <span class="n">variable_name</span><span class="o">=</span><span class="p">([</span><span class="s1">&#39;set&#39;</span><span class="p">,</span> <span class="s1">&#39;.value&#39;</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;(.+)_(.+)&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>set</th><th>loc</th><th>lat</th><th>long</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>off</td><td>A</td><td>121.271</td><td>&minus;7.18863</td></tr>
    <tr><td class='row_index'>1</td><td>off</td><td>B</td><td>75.9385</td><td>&minus;143.229</td></tr>
    <tr><td class='row_index'>2</td><td>off</td><td>C</td><td>135.044</td><td>21.2426</td></tr>
    <tr><td class='row_index'>3</td><td>off</td><td>D</td><td>134.511</td><td>40.9374</td></tr>
    <tr><td class='row_index'>4</td><td>off</td><td>E</td><td>134.484</td><td>40.7847</td></tr>
    <tr><td class='row_index'>5</td><td>off</td><td>F</td><td>137.962</td><td>22.9059</td></tr>
    <tr><td class='row_index'>6</td><td>pt</td><td>G</td><td>100.075</td><td>4.47209</td></tr>
    <tr><td class='row_index'>7</td><td>pt</td><td>H</td><td>75.1913</td><td>&minus;144.388</td></tr>
    <tr><td class='row_index'>8</td><td>pt</td><td>I</td><td>122.651</td><td>&minus;40.4561</td></tr>
    <tr><td class='row_index'>9</td><td>pt</td><td>J</td><td>124.136</td><td>&minus;46.0716</td></tr>
    <tr><td class='row_index'>10</td><td>pt</td><td>K</td><td>124.136</td><td>&minus;46.0716</td></tr>
    <tr><td class='row_index'>11</td><td>pt</td><td>L</td><td>124.01</td><td>&minus;46.0159</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>12 rows &times; 4 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DT</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">Frame</span><span class="p">({</span><span class="s1">&#39;Location&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Madrid&#39;</span><span class="p">,</span> <span class="s1">&#39;Madrid&#39;</span><span class="p">,</span> <span class="s1">&#39;Rome&#39;</span><span class="p">,</span> <span class="s1">&#39;Rome&#39;</span><span class="p">],</span>
 <span class="s1">&#39;Account&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;ABC&#39;</span><span class="p">,</span> <span class="s1">&#39;XYX&#39;</span><span class="p">,</span> <span class="s1">&#39;ABC&#39;</span><span class="p">,</span> <span class="s1">&#39;XYX&#39;</span><span class="p">],</span>
 <span class="s1">&#39;Y2019:MTD:January:Expense&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4354</span><span class="p">,</span> <span class="mi">769867</span><span class="p">,</span> <span class="mi">434654</span><span class="p">,</span> <span class="mi">632556456</span><span class="p">],</span>
 <span class="s1">&#39;Y2019:MTD:January:Income&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">56456</span><span class="p">,</span> <span class="mi">32556456</span><span class="p">,</span> <span class="mi">5214</span><span class="p">,</span> <span class="mi">46724423</span><span class="p">],</span>
 <span class="s1">&#39;Y2019:MTD:February:Expense&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">235423</span><span class="p">,</span> <span class="mi">6785423</span><span class="p">,</span> <span class="mi">235423</span><span class="p">,</span> <span class="mi">46588</span><span class="p">]})</span>

<span class="n">DT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>Location</th><th>Account</th><th>Y2019:MTD:January:Expense</th><th>Y2019:MTD:January:Income</th><th>Y2019:MTD:February:Expense</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>Madrid</td><td>ABC</td><td>4354</td><td>56456</td><td>235423</td></tr>
    <tr><td class='row_index'>1</td><td>Madrid</td><td>XYX</td><td>769867</td><td>32556456</td><td>6785423</td></tr>
    <tr><td class='row_index'>2</td><td>Rome</td><td>ABC</td><td>434654</td><td>5214</td><td>235423</td></tr>
    <tr><td class='row_index'>3</td><td>Rome</td><td>XYX</td><td>632556456</td><td>46724423</td><td>46588</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>4 rows &times; 5 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melt</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">,</span> <span class="s1">&#39;Account&#39;</span><span class="p">],</span> <span class="n">variable_name</span><span class="o">=</span><span class="p">([</span><span class="s1">&#39;year&#39;</span><span class="p">,</span><span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;.value&#39;</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;Y(.+):MTD:(.</span><span class="si">{3}</span><span class="s2">).+(Income|Expense)&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>Location</th><th>Account</th><th>year</th><th>month</th><th>Expense</th><th>Income</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>Madrid</td><td>ABC</td><td>2019</td><td>Jan</td><td>4354</td><td>56456</td></tr>
    <tr><td class='row_index'>1</td><td>Madrid</td><td>XYX</td><td>2019</td><td>Jan</td><td>769867</td><td>32556456</td></tr>
    <tr><td class='row_index'>2</td><td>Rome</td><td>ABC</td><td>2019</td><td>Jan</td><td>434654</td><td>5214</td></tr>
    <tr><td class='row_index'>3</td><td>Rome</td><td>XYX</td><td>2019</td><td>Jan</td><td>632556456</td><td>46724423</td></tr>
    <tr><td class='row_index'>4</td><td>Madrid</td><td>ABC</td><td>2019</td><td>Feb</td><td>235423</td><td><span class=na>NA</span></td></tr>
    <tr><td class='row_index'>5</td><td>Madrid</td><td>XYX</td><td>2019</td><td>Feb</td><td>6785423</td><td><span class=na>NA</span></td></tr>
    <tr><td class='row_index'>6</td><td>Rome</td><td>ABC</td><td>2019</td><td>Feb</td><td>235423</td><td><span class=na>NA</span></td></tr>
    <tr><td class='row_index'>7</td><td>Rome</td><td>XYX</td><td>2019</td><td>Feb</td><td>46588</td><td><span class=na>NA</span></td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>8 rows &times; 6 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>Location</th><th>Account</th><th>Y2019:MTD:January:Expense</th><th>Y2019:MTD:January:Income</th><th>Y2019:MTD:February:Expense</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>Madrid</td><td>ABC</td><td>4354</td><td>56456</td><td>235423</td></tr>
    <tr><td class='row_index'>1</td><td>Madrid</td><td>XYX</td><td>769867</td><td>32556456</td><td>6785423</td></tr>
    <tr><td class='row_index'>2</td><td>Rome</td><td>ABC</td><td>434654</td><td>5214</td><td>235423</td></tr>
    <tr><td class='row_index'>3</td><td>Rome</td><td>XYX</td><td>632556456</td><td>46724423</td><td>46588</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>4 rows &times; 5 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DT</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;country&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;United States&quot;</span><span class="p">,</span> <span class="s2">&quot;Russia&quot;</span><span class="p">,</span> <span class="s2">&quot;China&quot;</span><span class="p">],</span>
                <span class="s2">&quot;vault_2012_f&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="mf">48.132</span><span class="p">,</span>
                    <span class="mf">46.366</span><span class="p">,</span>
                    <span class="mf">44.266</span><span class="p">,</span>
                <span class="p">],</span>
                <span class="s2">&quot;vault_2012_m&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">46.632</span><span class="p">,</span> <span class="mf">46.866</span><span class="p">,</span> <span class="mf">48.316</span><span class="p">],</span>
                <span class="s2">&quot;vault_2016_f&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="mf">46.866</span><span class="p">,</span>
                    <span class="mf">45.733</span><span class="p">,</span>
                    <span class="mf">44.332</span><span class="p">,</span>
                <span class="p">],</span>
                <span class="s2">&quot;vault_2016_m&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">45.865</span><span class="p">,</span> <span class="mf">46.033</span><span class="p">,</span> <span class="mf">45.0</span><span class="p">],</span>
                <span class="s2">&quot;floor_2012_f&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">45.366</span><span class="p">,</span> <span class="mf">41.599</span><span class="p">,</span> <span class="mf">40.833</span><span class="p">],</span>
                <span class="s2">&quot;floor_2012_m&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">45.266</span><span class="p">,</span> <span class="mf">45.308</span><span class="p">,</span> <span class="mf">45.133</span><span class="p">],</span>
                <span class="s2">&quot;floor_2016_f&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">45.999</span><span class="p">,</span> <span class="mf">42.032</span><span class="p">,</span> <span class="mf">42.066</span><span class="p">],</span>
                <span class="s2">&quot;floor_2016_m&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">43.757</span><span class="p">,</span> <span class="mf">44.766</span><span class="p">,</span> <span class="mf">43.799</span><span class="p">],</span>
            <span class="p">}</span>
        <span class="p">)</span>

<span class="n">DT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>country</th><th>vault_2012_f</th><th>vault_2012_m</th><th>vault_2016_f</th><th>vault_2016_m</th><th>floor_2012_f</th><th>floor_2012_m</th><th>floor_2016_f</th><th>floor_2016_m</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>United States</td><td>48.132</td><td>46.632</td><td>46.866</td><td>45.865</td><td>45.366</td><td>45.266</td><td>45.999</td><td>43.757</td></tr>
    <tr><td class='row_index'>1</td><td>Russia</td><td>46.366</td><td>46.866</td><td>45.733</td><td>46.033</td><td>41.599</td><td>45.308</td><td>42.032</td><td>44.766</td></tr>
    <tr><td class='row_index'>2</td><td>China</td><td>44.266</td><td>48.316</td><td>44.332</td><td>45</td><td>40.833</td><td>45.133</td><td>42.066</td><td>43.799</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>3 rows &times; 9 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melt</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="n">variable_name</span><span class="o">=</span><span class="p">([</span><span class="s1">&#39;event&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;gender&#39;</span><span class="p">],</span> <span class="s1">&#39;_&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>country</th><th>event</th><th>year</th><th>gender</th><th>value</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>United States</td><td>vault</td><td>2012</td><td>f</td><td>48.132</td></tr>
    <tr><td class='row_index'>1</td><td>Russia</td><td>vault</td><td>2012</td><td>f</td><td>46.366</td></tr>
    <tr><td class='row_index'>2</td><td>China</td><td>vault</td><td>2012</td><td>f</td><td>44.266</td></tr>
    <tr><td class='row_index'>3</td><td>United States</td><td>vault</td><td>2012</td><td>m</td><td>46.632</td></tr>
    <tr><td class='row_index'>4</td><td>Russia</td><td>vault</td><td>2012</td><td>m</td><td>46.866</td></tr>
    <tr><td class='row_index'>5</td><td>China</td><td>vault</td><td>2012</td><td>m</td><td>48.316</td></tr>
    <tr><td class='row_index'>6</td><td>United States</td><td>vault</td><td>2016</td><td>f</td><td>46.866</td></tr>
    <tr><td class='row_index'>7</td><td>Russia</td><td>vault</td><td>2016</td><td>f</td><td>45.733</td></tr>
    <tr><td class='row_index'>8</td><td>China</td><td>vault</td><td>2016</td><td>f</td><td>44.332</td></tr>
    <tr><td class='row_index'>9</td><td>United States</td><td>vault</td><td>2016</td><td>m</td><td>45.865</td></tr>
    <tr><td class='row_index'>10</td><td>Russia</td><td>vault</td><td>2016</td><td>m</td><td>46.033</td></tr>
    <tr><td class='row_index'>11</td><td>China</td><td>vault</td><td>2016</td><td>m</td><td>45</td></tr>
    <tr><td class='row_index'>12</td><td>United States</td><td>floor</td><td>2012</td><td>f</td><td>45.366</td></tr>
    <tr><td class='row_index'>13</td><td>Russia</td><td>floor</td><td>2012</td><td>f</td><td>41.599</td></tr>
    <tr><td class='row_index'>14</td><td>China</td><td>floor</td><td>2012</td><td>f</td><td>40.833</td></tr>
    <tr><td class='row_index'>15</td><td>United States</td><td>floor</td><td>2012</td><td>m</td><td>45.266</td></tr>
    <tr><td class='row_index'>16</td><td>Russia</td><td>floor</td><td>2012</td><td>m</td><td>45.308</td></tr>
    <tr><td class='row_index'>17</td><td>China</td><td>floor</td><td>2012</td><td>m</td><td>45.133</td></tr>
    <tr><td class='row_index'>18</td><td>United States</td><td>floor</td><td>2016</td><td>f</td><td>45.999</td></tr>
    <tr><td class='row_index'>19</td><td>Russia</td><td>floor</td><td>2016</td><td>f</td><td>42.032</td></tr>
    <tr><td class='row_index'>20</td><td>China</td><td>floor</td><td>2016</td><td>f</td><td>42.066</td></tr>
    <tr><td class='row_index'>21</td><td>United States</td><td>floor</td><td>2016</td><td>m</td><td>43.757</td></tr>
    <tr><td class='row_index'>22</td><td>Russia</td><td>floor</td><td>2016</td><td>m</td><td>44.766</td></tr>
    <tr><td class='row_index'>23</td><td>China</td><td>floor</td><td>2016</td><td>m</td><td>43.799</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>24 rows &times; 5 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">measure</span><span class="p">([</span><span class="s1">&#39;event&#39;</span><span class="p">,</span><span class="s1">&#39;country&#39;</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>measure(column_names=[&#39;event&#39;, &#39;country&#39;], sep=None, pattern=&#39;_&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DT</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">Frame</span><span class="p">({</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
 <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;ABC&#39;</span><span class="p">,</span> <span class="s1">&#39;XYZ&#39;</span><span class="p">],</span>
 <span class="s1">&#39;code&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
 <span class="s1">&#39;code1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
 <span class="s1">&#39;code2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
 <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;R&#39;</span><span class="p">],</span>
 <span class="s1">&#39;type1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
 <span class="s1">&#39;type2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span><span class="p">]})</span>


<span class="n">DT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>id</th><th>Name</th><th>code</th><th>code1</th><th>code2</th><th>type</th><th>type1</th><th>type2</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='int' title='int8'>&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>0</td><td>ABC</td><td>1</td><td>4</td><td>8</td><td>S</td><td>E</td><td>T</td></tr>
    <tr><td class='row_index'>1</td><td>1</td><td>XYZ</td><td>2</td><td><span class=na>NA</span></td><td>5</td><td>R</td><td><span class=na>NA</span></td><td>U</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>2 rows &times; 8 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melt</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span> <span class="n">id_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">],</span> <span class="n">variable_name</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;code_all&#39;</span><span class="p">:</span><span class="s1">&#39;^code&#39;</span><span class="p">,</span> <span class="s1">&#39;type_all&#39;</span><span class="p">:</span><span class="s1">&#39;^type&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>id</th><th>Name</th><th>code_all</th><th>type_all</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='int' title='int8'>&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>0</td><td>ABC</td><td>1</td><td>S</td></tr>
    <tr><td class='row_index'>1</td><td>1</td><td>XYZ</td><td>2</td><td>R</td></tr>
    <tr><td class='row_index'>2</td><td>0</td><td>ABC</td><td>4</td><td>E</td></tr>
    <tr><td class='row_index'>3</td><td>1</td><td>XYZ</td><td><span class=na>NA</span></td><td><span class=na>NA</span></td></tr>
    <tr><td class='row_index'>4</td><td>0</td><td>ABC</td><td>8</td><td>T</td></tr>
    <tr><td class='row_index'>5</td><td>1</td><td>XYZ</td><td>5</td><td>U</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>6 rows &times; 4 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DT</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;ID&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;DateRange1Start&quot;</span><span class="p">:</span> <span class="s2">&quot;1/1/90&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;DateRange1End&quot;</span><span class="p">:</span> <span class="s2">&quot;3/1/90&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Value1&quot;</span><span class="p">:</span> <span class="mf">4.4</span><span class="p">,</span>
                    <span class="s2">&quot;DateRange2Start&quot;</span><span class="p">:</span> <span class="s2">&quot;4/5/91&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;DateRange2End&quot;</span><span class="p">:</span> <span class="s2">&quot;6/7/91&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Value2&quot;</span><span class="p">:</span> <span class="mf">6.2</span><span class="p">,</span>
                    <span class="s2">&quot;DateRange3Start&quot;</span><span class="p">:</span> <span class="s2">&quot;5/5/95&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;DateRange3End&quot;</span><span class="p">:</span> <span class="s2">&quot;6/6/96&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Value3&quot;</span><span class="p">:</span> <span class="mf">3.3</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">])</span>

<span class="n">DT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>ID</th><th>DateRange1Start</th><th>DateRange1End</th><th>Value1</th><th>DateRange2Start</th><th>DateRange2End</th><th>Value2</th><th>DateRange3Start</th><th>DateRange3End</th><th>Value3</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='int' title='int8'>&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>1</td><td>1/1/90</td><td>3/1/90</td><td>4.4</td><td>4/5/91</td><td>6/7/91</td><td>6.2</td><td>5/5/95</td><td>6/6/96</td><td>3.3</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>1 row &times; 10 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melt</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="n">variable_name</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;DateRangeStart&quot;</span><span class="p">:</span><span class="s2">&quot;Start$&quot;</span><span class="p">,</span> <span class="s1">&#39;DateRangeEnd&#39;</span><span class="p">:</span><span class="s1">&#39;End$&#39;</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">:</span><span class="s1">&#39;^Value&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>ID</th><th>DateRangeStart</th><th>DateRangeEnd</th><th>Value</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='int' title='int8'>&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>1</td><td>1/1/90</td><td>3/1/90</td><td>4.4</td></tr>
    <tr><td class='row_index'>1</td><td>1</td><td>4/5/91</td><td>6/7/91</td><td>6.2</td></tr>
    <tr><td class='row_index'>2</td><td>1</td><td>5/5/95</td><td>6/6/96</td><td>3.3</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>3 rows &times; 4 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DT</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;country&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;United States&quot;</span><span class="p">,</span> <span class="s2">&quot;Russia&quot;</span><span class="p">,</span> <span class="s2">&quot;China&quot;</span><span class="p">],</span>
                <span class="s2">&quot;vault_2012_f&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="mf">48.132</span><span class="p">,</span>
                    <span class="mf">46.366</span><span class="p">,</span>
                    <span class="mf">44.266</span><span class="p">,</span>
                <span class="p">],</span>
                <span class="s2">&quot;vault_2012_m&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">46.632</span><span class="p">,</span> <span class="mf">46.866</span><span class="p">,</span> <span class="mf">48.316</span><span class="p">],</span>
                <span class="s2">&quot;vault_2016_f&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="mf">46.866</span><span class="p">,</span>
                    <span class="mf">45.733</span><span class="p">,</span>
                    <span class="mf">44.332</span><span class="p">,</span>
                <span class="p">],</span>
                <span class="s2">&quot;vault_2016_m&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">45.865</span><span class="p">,</span> <span class="mf">46.033</span><span class="p">,</span> <span class="mf">45.0</span><span class="p">],</span>
                <span class="s2">&quot;floor_2012_f&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">45.366</span><span class="p">,</span> <span class="mf">41.599</span><span class="p">,</span> <span class="mf">40.833</span><span class="p">],</span>
                <span class="s2">&quot;floor_2012_m&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">45.266</span><span class="p">,</span> <span class="mf">45.308</span><span class="p">,</span> <span class="mf">45.133</span><span class="p">],</span>
                <span class="s2">&quot;floor_2016_f&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">45.999</span><span class="p">,</span> <span class="mf">42.032</span><span class="p">,</span> <span class="mf">42.066</span><span class="p">],</span>
                <span class="s2">&quot;floor_2016_m&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">43.757</span><span class="p">,</span> <span class="mf">44.766</span><span class="p">,</span> <span class="mf">43.799</span><span class="p">],</span>
            <span class="p">}</span>
        <span class="p">)</span>

<span class="n">DT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>country</th><th>vault_2012_f</th><th>vault_2012_m</th><th>vault_2016_f</th><th>vault_2016_m</th><th>floor_2012_f</th><th>floor_2012_m</th><th>floor_2016_f</th><th>floor_2016_m</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>United States</td><td>48.132</td><td>46.632</td><td>46.866</td><td>45.865</td><td>45.366</td><td>45.266</td><td>45.999</td><td>43.757</td></tr>
    <tr><td class='row_index'>1</td><td>Russia</td><td>46.366</td><td>46.866</td><td>45.733</td><td>46.033</td><td>41.599</td><td>45.308</td><td>42.032</td><td>44.766</td></tr>
    <tr><td class='row_index'>2</td><td>China</td><td>44.266</td><td>48.316</td><td>44.332</td><td>45</td><td>40.833</td><td>45.133</td><td>42.066</td><td>43.799</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>3 rows &times; 9 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pat</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;(?P&lt;event&gt;[a-z]+)_(?P&lt;year&gt;\d+)_(?P&lt;gender&gt;.+)&quot;</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">melt</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="n">variable_name</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">pat</span><span class="p">))</span>
<span class="n">out</span>
<span class="c1">#dt.Frame(out)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>country</th><th>event</th><th>year</th><th>gender</th><th>value</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>United States</td><td>vault</td><td>2012</td><td>f</td><td>48.132</td></tr>
    <tr><td class='row_index'>1</td><td>Russia</td><td>vault</td><td>2012</td><td>f</td><td>46.366</td></tr>
    <tr><td class='row_index'>2</td><td>China</td><td>vault</td><td>2012</td><td>f</td><td>44.266</td></tr>
    <tr><td class='row_index'>3</td><td>United States</td><td>vault</td><td>2012</td><td>m</td><td>46.632</td></tr>
    <tr><td class='row_index'>4</td><td>Russia</td><td>vault</td><td>2012</td><td>m</td><td>46.866</td></tr>
    <tr><td class='row_index'>5</td><td>China</td><td>vault</td><td>2012</td><td>m</td><td>48.316</td></tr>
    <tr><td class='row_index'>6</td><td>United States</td><td>vault</td><td>2016</td><td>f</td><td>46.866</td></tr>
    <tr><td class='row_index'>7</td><td>Russia</td><td>vault</td><td>2016</td><td>f</td><td>45.733</td></tr>
    <tr><td class='row_index'>8</td><td>China</td><td>vault</td><td>2016</td><td>f</td><td>44.332</td></tr>
    <tr><td class='row_index'>9</td><td>United States</td><td>vault</td><td>2016</td><td>m</td><td>45.865</td></tr>
    <tr><td class='row_index'>10</td><td>Russia</td><td>vault</td><td>2016</td><td>m</td><td>46.033</td></tr>
    <tr><td class='row_index'>11</td><td>China</td><td>vault</td><td>2016</td><td>m</td><td>45</td></tr>
    <tr><td class='row_index'>12</td><td>United States</td><td>floor</td><td>2012</td><td>f</td><td>45.366</td></tr>
    <tr><td class='row_index'>13</td><td>Russia</td><td>floor</td><td>2012</td><td>f</td><td>41.599</td></tr>
    <tr><td class='row_index'>14</td><td>China</td><td>floor</td><td>2012</td><td>f</td><td>40.833</td></tr>
    <tr><td class='row_index'>15</td><td>United States</td><td>floor</td><td>2012</td><td>m</td><td>45.266</td></tr>
    <tr><td class='row_index'>16</td><td>Russia</td><td>floor</td><td>2012</td><td>m</td><td>45.308</td></tr>
    <tr><td class='row_index'>17</td><td>China</td><td>floor</td><td>2012</td><td>m</td><td>45.133</td></tr>
    <tr><td class='row_index'>18</td><td>United States</td><td>floor</td><td>2016</td><td>f</td><td>45.999</td></tr>
    <tr><td class='row_index'>19</td><td>Russia</td><td>floor</td><td>2016</td><td>f</td><td>42.032</td></tr>
    <tr><td class='row_index'>20</td><td>China</td><td>floor</td><td>2016</td><td>f</td><td>42.066</td></tr>
    <tr><td class='row_index'>21</td><td>United States</td><td>floor</td><td>2016</td><td>m</td><td>43.757</td></tr>
    <tr><td class='row_index'>22</td><td>Russia</td><td>floor</td><td>2016</td><td>m</td><td>44.766</td></tr>
    <tr><td class='row_index'>23</td><td>China</td><td>floor</td><td>2016</td><td>m</td><td>43.799</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>24 rows &times; 5 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DT</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">Frame</span><span class="p">({</span><span class="s1">&#39;subject&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                   <span class="s1">&#39;A_target_word_gd&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
                   <span class="s1">&#39;A_target_word_fd&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
                   <span class="s1">&#39;B_target_word_gd&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span>
                   <span class="s1">&#39;B_target_word_fd&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span>
                   <span class="s1">&#39;subject_type&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;mild&#39;</span><span class="p">,</span> <span class="s1">&#39;moderate&#39;</span><span class="p">]})</span>


<span class="n">DT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>subject</th><th>A_target_word_gd</th><th>A_target_word_fd</th><th>B_target_word_gd</th><th>B_target_word_fd</th><th>subject_type</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>1</td><td>1</td><td>2</td><td>3</td><td>4</td><td>mild</td></tr>
    <tr><td class='row_index'>1</td><td>2</td><td>11</td><td>12</td><td>13</td><td>14</td><td>moderate</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>2 rows &times; 6 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pat</span> <span class="o">=</span> <span class="s2">&quot;(?P&lt;cond&gt;[A-Z]).*(?P&lt;value_type&gt;gd|fd)&quot;</span>
<span class="n">melt</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;subject&quot;</span><span class="p">,</span> <span class="s2">&quot;subject_type&quot;</span><span class="p">],</span> <span class="n">variable_name</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">pat</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>subject</th><th>subject_type</th><th>cond</th><th>value_type</th><th>value</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>1</td><td>mild</td><td>A</td><td>gd</td><td>1</td></tr>
    <tr><td class='row_index'>1</td><td>2</td><td>moderate</td><td>A</td><td>gd</td><td>11</td></tr>
    <tr><td class='row_index'>2</td><td>1</td><td>mild</td><td>A</td><td>fd</td><td>2</td></tr>
    <tr><td class='row_index'>3</td><td>2</td><td>moderate</td><td>A</td><td>fd</td><td>12</td></tr>
    <tr><td class='row_index'>4</td><td>1</td><td>mild</td><td>B</td><td>gd</td><td>3</td></tr>
    <tr><td class='row_index'>5</td><td>2</td><td>moderate</td><td>B</td><td>gd</td><td>13</td></tr>
    <tr><td class='row_index'>6</td><td>1</td><td>mild</td><td>B</td><td>fd</td><td>4</td></tr>
    <tr><td class='row_index'>7</td><td>2</td><td>moderate</td><td>B</td><td>fd</td><td>14</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>8 rows &times; 5 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DT</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">Frame</span><span class="p">({</span>
    <span class="s1">&#39;famid&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="s1">&#39;birth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="s1">&#39;ht1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.8</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">],</span>
    <span class="s1">&#39;ht2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.4</span><span class="p">,</span> <span class="mf">3.8</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="mf">2.8</span><span class="p">,</span> <span class="mf">2.4</span><span class="p">,</span> <span class="mf">3.3</span><span class="p">,</span> <span class="mf">3.4</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">]</span>
<span class="p">})</span>

<span class="n">DT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>famid</th><th>birth</th><th>ht1</th><th>ht2</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>1</td><td>1</td><td>2.8</td><td>3.4</td></tr>
    <tr><td class='row_index'>1</td><td>1</td><td>2</td><td>2.9</td><td>3.8</td></tr>
    <tr><td class='row_index'>2</td><td>1</td><td>3</td><td>2.2</td><td>2.9</td></tr>
    <tr><td class='row_index'>3</td><td>2</td><td>1</td><td>2</td><td>3.2</td></tr>
    <tr><td class='row_index'>4</td><td>2</td><td>2</td><td>1.8</td><td>2.8</td></tr>
    <tr><td class='row_index'>5</td><td>2</td><td>3</td><td>1.9</td><td>2.4</td></tr>
    <tr><td class='row_index'>6</td><td>3</td><td>1</td><td>2.2</td><td>3.3</td></tr>
    <tr><td class='row_index'>7</td><td>3</td><td>2</td><td>2.3</td><td>3.4</td></tr>
    <tr><td class='row_index'>8</td><td>3</td><td>3</td><td>2.1</td><td>2.9</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>9 rows &times; 4 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DT</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span> <span class="mi">10_000</span><span class="p">)</span>
<span class="n">DT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>famid</th><th>birth</th><th>ht1</th><th>ht2</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>1</td><td>1</td><td>2.8</td><td>3.4</td></tr>
    <tr><td class='row_index'>1</td><td>1</td><td>2</td><td>2.9</td><td>3.8</td></tr>
    <tr><td class='row_index'>2</td><td>1</td><td>3</td><td>2.2</td><td>2.9</td></tr>
    <tr><td class='row_index'>3</td><td>2</td><td>1</td><td>2</td><td>3.2</td></tr>
    <tr><td class='row_index'>4</td><td>2</td><td>2</td><td>1.8</td><td>2.8</td></tr>
    <tr><td class='row_index'>5</td><td>2</td><td>3</td><td>1.9</td><td>2.4</td></tr>
    <tr><td class='row_index'>6</td><td>3</td><td>1</td><td>2.2</td><td>3.3</td></tr>
    <tr><td class='row_index'>7</td><td>3</td><td>2</td><td>2.3</td><td>3.4</td></tr>
    <tr><td class='row_index'>8</td><td>3</td><td>3</td><td>2.1</td><td>2.9</td></tr>
    <tr><td class='row_index'>9</td><td>1</td><td>1</td><td>2.8</td><td>3.4</td></tr>
    <tr><td class='row_index'>10</td><td>1</td><td>2</td><td>2.9</td><td>3.8</td></tr>
    <tr><td class='row_index'>11</td><td>1</td><td>3</td><td>2.2</td><td>2.9</td></tr>
    <tr><td class='row_index'>12</td><td>2</td><td>1</td><td>2</td><td>3.2</td></tr>
    <tr><td class='row_index'>13</td><td>2</td><td>2</td><td>1.8</td><td>2.8</td></tr>
    <tr><td class='row_index'>14</td><td>2</td><td>3</td><td>1.9</td><td>2.4</td></tr>
    <tr><td class='row_index'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td></tr>
    <tr><td class='row_index'>89,995</td><td>2</td><td>2</td><td>1.8</td><td>2.8</td></tr>
    <tr><td class='row_index'>89,996</td><td>2</td><td>3</td><td>1.9</td><td>2.4</td></tr>
    <tr><td class='row_index'>89,997</td><td>3</td><td>1</td><td>2.2</td><td>3.3</td></tr>
    <tr><td class='row_index'>89,998</td><td>3</td><td>2</td><td>2.3</td><td>3.4</td></tr>
    <tr><td class='row_index'>89,999</td><td>3</td><td>3</td><td>2.1</td><td>2.9</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>90,000 rows &times; 4 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melt</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span> <span class="n">id_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;famid&#39;</span><span class="p">,</span> <span class="s1">&#39;birth&#39;</span><span class="p">],</span> <span class="n">variable_name</span><span class="o">=</span><span class="p">([</span><span class="s1">&#39;.value&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;(.+)(.)&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>famid</th><th>birth</th><th>age</th><th>ht</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>1</td><td>1</td><td>1</td><td>2.8</td></tr>
    <tr><td class='row_index'>1</td><td>1</td><td>2</td><td>1</td><td>2.9</td></tr>
    <tr><td class='row_index'>2</td><td>1</td><td>3</td><td>1</td><td>2.2</td></tr>
    <tr><td class='row_index'>3</td><td>2</td><td>1</td><td>1</td><td>2</td></tr>
    <tr><td class='row_index'>4</td><td>2</td><td>2</td><td>1</td><td>1.8</td></tr>
    <tr><td class='row_index'>5</td><td>2</td><td>3</td><td>1</td><td>1.9</td></tr>
    <tr><td class='row_index'>6</td><td>3</td><td>1</td><td>1</td><td>2.2</td></tr>
    <tr><td class='row_index'>7</td><td>3</td><td>2</td><td>1</td><td>2.3</td></tr>
    <tr><td class='row_index'>8</td><td>3</td><td>3</td><td>1</td><td>2.1</td></tr>
    <tr><td class='row_index'>9</td><td>1</td><td>1</td><td>1</td><td>2.8</td></tr>
    <tr><td class='row_index'>10</td><td>1</td><td>2</td><td>1</td><td>2.9</td></tr>
    <tr><td class='row_index'>11</td><td>1</td><td>3</td><td>1</td><td>2.2</td></tr>
    <tr><td class='row_index'>12</td><td>2</td><td>1</td><td>1</td><td>2</td></tr>
    <tr><td class='row_index'>13</td><td>2</td><td>2</td><td>1</td><td>1.8</td></tr>
    <tr><td class='row_index'>14</td><td>2</td><td>3</td><td>1</td><td>1.9</td></tr>
    <tr><td class='row_index'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td></tr>
    <tr><td class='row_index'>179,995</td><td>2</td><td>2</td><td>2</td><td>2.8</td></tr>
    <tr><td class='row_index'>179,996</td><td>2</td><td>3</td><td>2</td><td>2.4</td></tr>
    <tr><td class='row_index'>179,997</td><td>3</td><td>1</td><td>2</td><td>3.3</td></tr>
    <tr><td class='row_index'>179,998</td><td>3</td><td>2</td><td>2</td><td>3.4</td></tr>
    <tr><td class='row_index'>179,999</td><td>3</td><td>3</td><td>2</td><td>2.9</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>180,000 rows &times; 4 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DT</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">Frame</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">)],</span>
                  <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;ax&#39;</span><span class="p">,</span><span class="s1">&#39;ay&#39;</span><span class="p">,</span><span class="s1">&#39;az&#39;</span><span class="p">,</span><span class="s1">&#39;bx&#39;</span><span class="p">,</span><span class="s1">&#39;by&#39;</span><span class="p">,</span><span class="s1">&#39;bz&#39;</span><span class="p">])</span>


<span class="n">DT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>id</th><th>ax</th><th>ay</th><th>az</th><th>bx</th><th>by</th><th>bz</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>1</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td></tr>
    <tr><td class='row_index'>1</td><td>2</td><td>7</td><td>8</td><td>9</td><td>10</td><td>11</td><td>12</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>2 rows &times; 7 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melt</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">variable_name</span><span class="o">=</span><span class="p">([</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;.value&#39;</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;(.)(.)&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>id</th><th>name</th><th>x</th><th>y</th><th>z</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>1</td><td>a</td><td>1</td><td>2</td><td>3</td></tr>
    <tr><td class='row_index'>1</td><td>2</td><td>a</td><td>7</td><td>8</td><td>9</td></tr>
    <tr><td class='row_index'>2</td><td>1</td><td>b</td><td>4</td><td>5</td><td>6</td></tr>
    <tr><td class='row_index'>3</td><td>2</td><td>b</td><td>10</td><td>11</td><td>12</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>4 rows &times; 5 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DT</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">Frame</span><span class="p">([{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;A1g_hi&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> 
                    <span class="s1">&#39;A2g_hi&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;A3g_hi&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> 
                    <span class="s1">&#39;A4g_hi&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}])</span>

<span class="n">DT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>id</th><th>A1g_hi</th><th>A2g_hi</th><th>A3g_hi</th><th>A4g_hi</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='int' title='int8'>&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>1 row &times; 5 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melt</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">variable_name</span><span class="o">=</span><span class="p">([</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;.value&#39;</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;A(.)g_(.+)&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>id</th><th>time</th><th>hi</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='int' title='int8'>&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>1</td><td>1</td><td>2</td></tr>
    <tr><td class='row_index'>1</td><td>1</td><td>2</td><td>3</td></tr>
    <tr><td class='row_index'>2</td><td>1</td><td>3</td><td>4</td></tr>
    <tr><td class='row_index'>3</td><td>1</td><td>4</td><td>5</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>4 rows &times; 3 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DT</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span>
    <span class="p">[{</span><span class="s1">&#39;Sony | TV | Model | value&#39;</span><span class="p">:</span> <span class="s1">&#39;A222&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Sony | TV | Quantity | value&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
  <span class="s1">&#39;Sony | TV | Max-quant | value&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
  <span class="s1">&#39;Panasonic | TV | Model | value&#39;</span><span class="p">:</span> <span class="s1">&#39;T232&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Panasonic | TV | Quantity | value&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="s1">&#39;Panasonic | TV | Max-quant | value&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
  <span class="s1">&#39;Sanyo | Radio | Model | value&#39;</span><span class="p">:</span> <span class="s1">&#39;S111&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Sanyo | Radio | Quantity | value&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
  <span class="s1">&#39;Sanyo | Radio | Max-quant | value&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;Sony | TV | Model | value&#39;</span><span class="p">:</span> <span class="s1">&#39;A234&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Sony | TV | Quantity | value&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
  <span class="s1">&#39;Sony | TV | Max-quant | value&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
  <span class="s1">&#39;Panasonic | TV | Model | value&#39;</span><span class="p">:</span> <span class="s1">&#39;S3424&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Panasonic | TV | Quantity | value&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
  <span class="s1">&#39;Panasonic | TV | Max-quant | value&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
  <span class="s1">&#39;Sanyo | Radio | Model | value&#39;</span><span class="p">:</span> <span class="s1">&#39;S1s1&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Sanyo | Radio | Quantity | value&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
  <span class="s1">&#39;Sanyo | Radio | Max-quant | value&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;Sony | TV | Model | value&#39;</span><span class="p">:</span> <span class="s1">&#39;A4345&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Sony | TV | Quantity | value&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
  <span class="s1">&#39;Sony | TV | Max-quant | value&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
  <span class="s1">&#39;Panasonic | TV | Model | value&#39;</span><span class="p">:</span> <span class="s1">&#39;X3421&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Panasonic | TV | Quantity | value&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="s1">&#39;Panasonic | TV | Max-quant | value&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
  <span class="s1">&#39;Sanyo | Radio | Model | value&#39;</span><span class="p">:</span> <span class="s1">&#39;S1s2&#39;</span><span class="p">,</span>
  <span class="s1">&#39;Sanyo | Radio | Quantity | value&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
  <span class="s1">&#39;Sanyo | Radio | Max-quant | value&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}]</span>
<span class="p">)</span>

<span class="n">DT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>Sony | TV | Model | value</th><th>Sony | TV | Quantity | value</th><th>Sony | TV | Max-quant | value</th><th>Panasonic | TV | Model | value</th><th>Panasonic | TV | Quantity | value</th><th>Panasonic | TV | Max-quant | value</th><th>Sanyo | Radio | Model | value</th><th>Sanyo | Radio | Quantity | value</th><th>Sanyo | Radio | Max-quant | value</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>A222</td><td>5</td><td>10</td><td>T232</td><td>1</td><td>10</td><td>S111</td><td>4</td><td>9</td></tr>
    <tr><td class='row_index'>1</td><td>A234</td><td>5</td><td>9</td><td>S3424</td><td>5</td><td>12</td><td>S1s1</td><td>2</td><td>9</td></tr>
    <tr><td class='row_index'>2</td><td>A4345</td><td>4</td><td>9</td><td>X3421</td><td>1</td><td>11</td><td>S1s2</td><td>4</td><td>10</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>3 rows &times; 9 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melt</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span> <span class="n">variable_name</span><span class="o">=</span><span class="p">([</span><span class="s2">&quot;Manufacturer&quot;</span><span class="p">,</span> <span class="s2">&quot;Device&quot;</span><span class="p">,</span> <span class="s2">&quot;.value&quot;</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;(.+)\|(.+)\|(.+)\|.*&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>Manufacturer</th><th>Device</th><th> Model </th><th> Quantity </th><th> Max-quant </th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>Sony </td><td> TV </td><td>A222</td><td>5</td><td>10</td></tr>
    <tr><td class='row_index'>1</td><td>Sony </td><td> TV </td><td>A234</td><td>5</td><td>9</td></tr>
    <tr><td class='row_index'>2</td><td>Sony </td><td> TV </td><td>A4345</td><td>4</td><td>9</td></tr>
    <tr><td class='row_index'>3</td><td>Panasonic </td><td> TV </td><td>T232</td><td>1</td><td>10</td></tr>
    <tr><td class='row_index'>4</td><td>Panasonic </td><td> TV </td><td>S3424</td><td>5</td><td>12</td></tr>
    <tr><td class='row_index'>5</td><td>Panasonic </td><td> TV </td><td>X3421</td><td>1</td><td>11</td></tr>
    <tr><td class='row_index'>6</td><td>Sanyo </td><td> Radio </td><td>S111</td><td>4</td><td>9</td></tr>
    <tr><td class='row_index'>7</td><td>Sanyo </td><td> Radio </td><td>S1s1</td><td>2</td><td>9</td></tr>
    <tr><td class='row_index'>8</td><td>Sanyo </td><td> Radio </td><td>S1s2</td><td>4</td><td>10</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>9 rows &times; 5 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DT</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">Frame</span><span class="p">({</span><span class="s1">&#39;first&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;John&#39;</span><span class="p">,</span> <span class="s1">&#39;Mary&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;last&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Doe&#39;</span><span class="p">,</span> <span class="s1">&#39;Bo&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">],</span>
                   <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">130</span><span class="p">,</span> <span class="mi">150</span><span class="p">]})</span>
<span class="n">DT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>first</th><th>last</th><th>height</th><th>weight</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>John</td><td>Doe</td><td>5.5</td><td>130</td></tr>
    <tr><td class='row_index'>1</td><td>Mary</td><td>Bo</td><td>6</td><td>150</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>2 rows &times; 4 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melt</span><span class="p">(</span><span class="n">DT</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>variable</th><th>value</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>first</td><td>John</td></tr>
    <tr><td class='row_index'>1</td><td>first</td><td>Mary</td></tr>
    <tr><td class='row_index'>2</td><td>last</td><td>Doe</td></tr>
    <tr><td class='row_index'>3</td><td>last</td><td>Bo</td></tr>
    <tr><td class='row_index'>4</td><td>height</td><td>5.5</td></tr>
    <tr><td class='row_index'>5</td><td>height</td><td>6.0</td></tr>
    <tr><td class='row_index'>6</td><td>weight</td><td>130</td></tr>
    <tr><td class='row_index'>7</td><td>weight</td><td>150</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>8 rows &times; 2 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melt</span><span class="p">(</span><span class="n">DT</span><span class="p">)</span><span class="o">.</span><span class="n">stypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(stype.str32, stype.str32)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melt</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;first&#39;</span><span class="p">,</span> <span class="s1">&#39;last&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>first</th><th>last</th><th>variable</th><th>value</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>John</td><td>Doe</td><td>height</td><td>5.5</td></tr>
    <tr><td class='row_index'>1</td><td>Mary</td><td>Bo</td><td>height</td><td>6</td></tr>
    <tr><td class='row_index'>2</td><td>John</td><td>Doe</td><td>weight</td><td>130</td></tr>
    <tr><td class='row_index'>3</td><td>Mary</td><td>Bo</td><td>weight</td><td>150</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>4 rows &times; 4 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/tidyverse/tidyr/main/data-raw/billboard.csv&#39;</span>
<span class="n">DT</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">fread</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">measure_vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">DT</span><span class="o">.</span><span class="n">names</span> <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;wk&#39;</span><span class="p">)]</span>
<span class="n">melt</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span> <span class="n">measure_vars</span><span class="o">=</span><span class="n">measure_vars</span><span class="p">,</span> <span class="n">variable_name</span><span class="o">=</span><span class="s1">&#39;week&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>year</th><th>artist</th><th>track</th><th>time</th><th>date.entered</th><th>week</th><th>value</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='time' title='date32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>2000</td><td>2 Pac</td><td>Baby Don't Cry (Keep...</td><td>4:22</td><td>2000-02-26</td><td>wk1</td><td>87</td></tr>
    <tr><td class='row_index'>1</td><td>2000</td><td>2Ge+her</td><td>The Hardest Part Of ...</td><td>3:15</td><td>2000-09-02</td><td>wk1</td><td>91</td></tr>
    <tr><td class='row_index'>2</td><td>2000</td><td>3 Doors Down</td><td>Kryptonite</td><td>3:53</td><td>2000-04-08</td><td>wk1</td><td>81</td></tr>
    <tr><td class='row_index'>3</td><td>2000</td><td>3 Doors Down</td><td>Loser</td><td>4:24</td><td>2000-10-21</td><td>wk1</td><td>76</td></tr>
    <tr><td class='row_index'>4</td><td>2000</td><td>504 Boyz</td><td>Wobble Wobble</td><td>3:35</td><td>2000-04-15</td><td>wk1</td><td>57</td></tr>
    <tr><td class='row_index'>5</td><td>2000</td><td>98^0</td><td>Give Me Just One Nig...</td><td>3:24</td><td>2000-08-19</td><td>wk1</td><td>51</td></tr>
    <tr><td class='row_index'>6</td><td>2000</td><td>A*Teens</td><td>Dancing Queen</td><td>3:44</td><td>2000-07-08</td><td>wk1</td><td>97</td></tr>
    <tr><td class='row_index'>7</td><td>2000</td><td>Aaliyah</td><td>I Don't Wanna</td><td>4:15</td><td>2000-01-29</td><td>wk1</td><td>84</td></tr>
    <tr><td class='row_index'>8</td><td>2000</td><td>Aaliyah</td><td>Try Again</td><td>4:03</td><td>2000-03-18</td><td>wk1</td><td>59</td></tr>
    <tr><td class='row_index'>9</td><td>2000</td><td>Adams, Yolanda</td><td>Open My Heart</td><td>5:30</td><td>2000-08-26</td><td>wk1</td><td>76</td></tr>
    <tr><td class='row_index'>10</td><td>2000</td><td>Adkins, Trace</td><td>More</td><td>3:05</td><td>2000-04-29</td><td>wk1</td><td>84</td></tr>
    <tr><td class='row_index'>11</td><td>2000</td><td>Aguilera, Christina</td><td>Come On Over Baby (A...</td><td>3:38</td><td>2000-08-05</td><td>wk1</td><td>57</td></tr>
    <tr><td class='row_index'>12</td><td>2000</td><td>Aguilera, Christina</td><td>I Turn To You</td><td>4:00</td><td>2000-04-15</td><td>wk1</td><td>50</td></tr>
    <tr><td class='row_index'>13</td><td>2000</td><td>Aguilera, Christina</td><td>What A Girl Wants</td><td>3:18</td><td>1999-11-27</td><td>wk1</td><td>71</td></tr>
    <tr><td class='row_index'>14</td><td>2000</td><td>Alice Deejay</td><td>Better Off Alone</td><td>6:50</td><td>2000-04-08</td><td>wk1</td><td>79</td></tr>
    <tr><td class='row_index'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td><td class='hellipsis'>&#x22EE;</td></tr>
    <tr><td class='row_index'>24,087</td><td>2000</td><td>Yankee Grey</td><td>Another Nine Minutes</td><td>3:10</td><td>2000-04-29</td><td>wk76</td><td><span class=na>NA</span></td></tr>
    <tr><td class='row_index'>24,088</td><td>2000</td><td>Yearwood, Trisha</td><td>Real Live Woman</td><td>3:55</td><td>2000-04-01</td><td>wk76</td><td><span class=na>NA</span></td></tr>
    <tr><td class='row_index'>24,089</td><td>2000</td><td>Ying Yang Twins</td><td>Whistle While You Tw...</td><td>4:19</td><td>2000-03-18</td><td>wk76</td><td><span class=na>NA</span></td></tr>
    <tr><td class='row_index'>24,090</td><td>2000</td><td>Zombie Nation</td><td>Kernkraft 400</td><td>3:30</td><td>2000-09-02</td><td>wk76</td><td><span class=na>NA</span></td></tr>
    <tr><td class='row_index'>24,091</td><td>2000</td><td>matchbox twenty</td><td>Bent</td><td>4:12</td><td>2000-04-29</td><td>wk76</td><td><span class=na>NA</span></td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>24,092 rows &times; 7 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DT</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">Frame</span><span class="p">([{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">}])</span>

<span class="n">DT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>A</th><th>B</th><th>C</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>a</td><td>1</td><td>2</td></tr>
    <tr><td class='row_index'>1</td><td>b</td><td>3</td><td>4</td></tr>
    <tr><td class='row_index'>2</td><td>c</td><td>5</td><td>6</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>3 rows &times; 3 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melt</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">measure_vars</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>A</th><th>variable</th><th>value</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>a</td><td>B</td><td>1</td></tr>
    <tr><td class='row_index'>1</td><td>b</td><td>B</td><td>3</td></tr>
    <tr><td class='row_index'>2</td><td>c</td><td>B</td><td>5</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>3 rows &times; 3 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melt</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">measure_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>A</th><th>variable</th><th>value</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>a</td><td>B</td><td>1</td></tr>
    <tr><td class='row_index'>1</td><td>b</td><td>B</td><td>3</td></tr>
    <tr><td class='row_index'>2</td><td>c</td><td>B</td><td>5</td></tr>
    <tr><td class='row_index'>3</td><td>a</td><td>C</td><td>2</td></tr>
    <tr><td class='row_index'>4</td><td>b</td><td>C</td><td>4</td></tr>
    <tr><td class='row_index'>5</td><td>c</td><td>C</td><td>6</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>6 rows &times; 3 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melt</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">measure_vars</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">variable_name</span><span class="o">=</span><span class="s1">&#39;myVarname&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;myValname&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>A</th><th>myVarname</th><th>myValname</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>a</td><td>B</td><td>1</td></tr>
    <tr><td class='row_index'>1</td><td>b</td><td>B</td><td>3</td></tr>
    <tr><td class='row_index'>2</td><td>c</td><td>B</td><td>5</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>3 rows &times; 3 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DT</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">Frame</span><span class="p">({</span><span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;John&#39;</span><span class="p">,</span> <span class="s1">&#39;Foo&#39;</span><span class="p">,</span> <span class="s1">&#39;Bar&#39;</span><span class="p">,</span> <span class="s1">&#39;Alex&#39;</span><span class="p">,</span> <span class="s1">&#39;Tom&#39;</span><span class="p">],</span> 
                   <span class="s1">&#39;Math&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A+&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span> 
                   <span class="s1">&#39;English&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A+&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;Age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">13</span><span class="p">]})</span>

<span class="n">DT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>Name</th><th>Math</th><th>English</th><th>Age</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>Bob</td><td>A+</td><td>C</td><td>13</td></tr>
    <tr><td class='row_index'>1</td><td>John</td><td>B</td><td>B</td><td>16</td></tr>
    <tr><td class='row_index'>2</td><td>Foo</td><td>A</td><td>B</td><td>16</td></tr>
    <tr><td class='row_index'>3</td><td>Bar</td><td>F</td><td>A+</td><td>15</td></tr>
    <tr><td class='row_index'>4</td><td>Alex</td><td>D</td><td>F</td><td>15</td></tr>
    <tr><td class='row_index'>5</td><td>Tom</td><td>C</td><td>A</td><td>13</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>6 rows &times; 4 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melt</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span> <span class="n">id_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Age&#39;</span><span class="p">],</span> <span class="n">measure_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Math&#39;</span><span class="p">,</span> <span class="s1">&#39;English&#39;</span><span class="p">],</span> <span class="n">variable_name</span><span class="o">=</span><span class="s1">&#39;Subject&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;Grade&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>Name</th><th>Age</th><th>Subject</th><th>Grade</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>Bob</td><td>13</td><td>Math</td><td>A+</td></tr>
    <tr><td class='row_index'>1</td><td>John</td><td>16</td><td>Math</td><td>B</td></tr>
    <tr><td class='row_index'>2</td><td>Foo</td><td>16</td><td>Math</td><td>A</td></tr>
    <tr><td class='row_index'>3</td><td>Bar</td><td>15</td><td>Math</td><td>F</td></tr>
    <tr><td class='row_index'>4</td><td>Alex</td><td>15</td><td>Math</td><td>D</td></tr>
    <tr><td class='row_index'>5</td><td>Tom</td><td>13</td><td>Math</td><td>C</td></tr>
    <tr><td class='row_index'>6</td><td>Bob</td><td>13</td><td>English</td><td>C</td></tr>
    <tr><td class='row_index'>7</td><td>John</td><td>16</td><td>English</td><td>B</td></tr>
    <tr><td class='row_index'>8</td><td>Foo</td><td>16</td><td>English</td><td>B</td></tr>
    <tr><td class='row_index'>9</td><td>Bar</td><td>15</td><td>English</td><td>A+</td></tr>
    <tr><td class='row_index'>10</td><td>Alex</td><td>15</td><td>English</td><td>F</td></tr>
    <tr><td class='row_index'>11</td><td>Tom</td><td>13</td><td>English</td><td>A</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>12 rows &times; 4 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DT</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">Frame</span><span class="p">({</span>
        <span class="s1">&#39;asset1&#39;</span><span class="p">:</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;acacac&#39;</span><span class="p">),</span>
         <span class="s1">&#39;asset2&#39;</span><span class="p">:[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="p">,</span>
         <span class="s1">&#39;A&#39;</span><span class="p">:[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
         <span class="s1">&#39;D&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
         <span class="s1">&#39;E&#39;</span><span class="p">:[</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="p">})</span>

<span class="n">DT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>asset1</th><th>asset2</th><th>A</th><th>D</th><th>E</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>a</td><td>4</td><td>7</td><td>1</td><td>5</td></tr>
    <tr><td class='row_index'>1</td><td>c</td><td>4</td><td>8</td><td>3</td><td>3</td></tr>
    <tr><td class='row_index'>2</td><td>a</td><td>4</td><td>9</td><td>5</td><td>6</td></tr>
    <tr><td class='row_index'>3</td><td>c</td><td>4</td><td>4</td><td>7</td><td>9</td></tr>
    <tr><td class='row_index'>4</td><td>a</td><td>4</td><td>2</td><td>1</td><td>2</td></tr>
    <tr><td class='row_index'>5</td><td>c</td><td>4</td><td>3</td><td>0</td><td>4</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>6 rows &times; 5 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melt</span><span class="p">(</span><span class="n">DT</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;asset1&#39;</span><span class="p">,</span> <span class="s1">&#39;asset2&#39;</span><span class="p">],</span> <span class="n">measure_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">],</span> <span class="n">variable_name</span><span class="o">=</span><span class="s1">&#39;c_name&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;Value&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>asset1</th><th>asset2</th><th>c_name</th><th>Value</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>a</td><td>4</td><td>A</td><td>7</td></tr>
    <tr><td class='row_index'>1</td><td>c</td><td>4</td><td>A</td><td>8</td></tr>
    <tr><td class='row_index'>2</td><td>a</td><td>4</td><td>A</td><td>9</td></tr>
    <tr><td class='row_index'>3</td><td>c</td><td>4</td><td>A</td><td>4</td></tr>
    <tr><td class='row_index'>4</td><td>a</td><td>4</td><td>A</td><td>2</td></tr>
    <tr><td class='row_index'>5</td><td>c</td><td>4</td><td>A</td><td>3</td></tr>
    <tr><td class='row_index'>6</td><td>a</td><td>4</td><td>D</td><td>1</td></tr>
    <tr><td class='row_index'>7</td><td>c</td><td>4</td><td>D</td><td>3</td></tr>
    <tr><td class='row_index'>8</td><td>a</td><td>4</td><td>D</td><td>5</td></tr>
    <tr><td class='row_index'>9</td><td>c</td><td>4</td><td>D</td><td>7</td></tr>
    <tr><td class='row_index'>10</td><td>a</td><td>4</td><td>D</td><td>1</td></tr>
    <tr><td class='row_index'>11</td><td>c</td><td>4</td><td>D</td><td>0</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>12 rows &times; 4 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DT</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">Frame</span><span class="p">({</span><span class="s1">&#39;New York&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">25</span><span class="p">]})</span>

<span class="n">DT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>New York</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>25</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>1 row &times; 1 column</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melt</span><span class="p">(</span><span class="n">DT</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>variable</th><th>value</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>New York</td><td>25</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>1 row &times; 2 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DT</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">Frame</span><span class="p">({</span><span class="s1">&#39;New york&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">25</span><span class="p">],</span> <span class="s1">&#39;Paris&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">27</span><span class="p">],</span> <span class="s1">&#39;London&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">30</span><span class="p">]})</span>

<span class="n">melt</span><span class="p">(</span><span class="n">DT</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>variable</th><th>value</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>New york</td><td>25</td></tr>
    <tr><td class='row_index'>1</td><td>Paris</td><td>27</td></tr>
    <tr><td class='row_index'>2</td><td>London</td><td>30</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>3 rows &times; 2 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temperatures</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">Frame</span><span class="p">({</span>
    <span class="s1">&#39;city&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;New York&#39;</span><span class="p">,</span> <span class="s1">&#39;London&#39;</span><span class="p">,</span> <span class="s1">&#39;Paris&#39;</span><span class="p">,</span> <span class="s1">&#39;Berlin&#39;</span><span class="p">,</span> <span class="s1">&#39;Amsterdam&#39;</span><span class="p">],</span>
    <span class="s1">&#39;day1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">24</span><span class="p">],</span>
    <span class="s1">&#39;day2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">22</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">23</span><span class="p">],</span>
    <span class="s1">&#39;day3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">26</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">23</span><span class="p">],</span>
    <span class="s1">&#39;day4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">],</span>
    <span class="s1">&#39;day5&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">27</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">28</span><span class="p">]</span>
<span class="p">})</span>

<span class="n">melt</span><span class="p">(</span><span class="n">temperatures</span><span class="p">,</span> <span class="n">id_vars</span> <span class="o">=</span> <span class="s1">&#39;city&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>city</th><th>variable</th><th>value</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='int' title='int32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>New York</td><td>day1</td><td>23</td></tr>
    <tr><td class='row_index'>1</td><td>London</td><td>day1</td><td>25</td></tr>
    <tr><td class='row_index'>2</td><td>Paris</td><td>day1</td><td>27</td></tr>
    <tr><td class='row_index'>3</td><td>Berlin</td><td>day1</td><td>26</td></tr>
    <tr><td class='row_index'>4</td><td>Amsterdam</td><td>day1</td><td>24</td></tr>
    <tr><td class='row_index'>5</td><td>New York</td><td>day2</td><td>22</td></tr>
    <tr><td class='row_index'>6</td><td>London</td><td>day2</td><td>21</td></tr>
    <tr><td class='row_index'>7</td><td>Paris</td><td>day2</td><td>25</td></tr>
    <tr><td class='row_index'>8</td><td>Berlin</td><td>day2</td><td>26</td></tr>
    <tr><td class='row_index'>9</td><td>Amsterdam</td><td>day2</td><td>23</td></tr>
    <tr><td class='row_index'>10</td><td>New York</td><td>day3</td><td>26</td></tr>
    <tr><td class='row_index'>11</td><td>London</td><td>day3</td><td>25</td></tr>
    <tr><td class='row_index'>12</td><td>Paris</td><td>day3</td><td>24</td></tr>
    <tr><td class='row_index'>13</td><td>Berlin</td><td>day3</td><td>27</td></tr>
    <tr><td class='row_index'>14</td><td>Amsterdam</td><td>day3</td><td>23</td></tr>
    <tr><td class='row_index'>15</td><td>New York</td><td>day4</td><td>23</td></tr>
    <tr><td class='row_index'>16</td><td>London</td><td>day4</td><td>21</td></tr>
    <tr><td class='row_index'>17</td><td>Paris</td><td>day4</td><td>22</td></tr>
    <tr><td class='row_index'>18</td><td>Berlin</td><td>day4</td><td>26</td></tr>
    <tr><td class='row_index'>19</td><td>Amsterdam</td><td>day4</td><td>27</td></tr>
    <tr><td class='row_index'>20</td><td>New York</td><td>day5</td><td>27</td></tr>
    <tr><td class='row_index'>21</td><td>London</td><td>day5</td><td>26</td></tr>
    <tr><td class='row_index'>22</td><td>Paris</td><td>day5</td><td>27</td></tr>
    <tr><td class='row_index'>23</td><td>Berlin</td><td>day5</td><td>24</td></tr>
    <tr><td class='row_index'>24</td><td>Amsterdam</td><td>day5</td><td>28</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>25 rows &times; 3 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melt</span><span class="p">(</span><span class="n">temperatures</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>variable</th><th>value</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>city</td><td>New York</td></tr>
    <tr><td class='row_index'>1</td><td>city</td><td>London</td></tr>
    <tr><td class='row_index'>2</td><td>city</td><td>Paris</td></tr>
    <tr><td class='row_index'>3</td><td>city</td><td>Berlin</td></tr>
    <tr><td class='row_index'>4</td><td>city</td><td>Amsterdam</td></tr>
    <tr><td class='row_index'>5</td><td>day1</td><td>23</td></tr>
    <tr><td class='row_index'>6</td><td>day1</td><td>25</td></tr>
    <tr><td class='row_index'>7</td><td>day1</td><td>27</td></tr>
    <tr><td class='row_index'>8</td><td>day1</td><td>26</td></tr>
    <tr><td class='row_index'>9</td><td>day1</td><td>24</td></tr>
    <tr><td class='row_index'>10</td><td>day2</td><td>22</td></tr>
    <tr><td class='row_index'>11</td><td>day2</td><td>21</td></tr>
    <tr><td class='row_index'>12</td><td>day2</td><td>25</td></tr>
    <tr><td class='row_index'>13</td><td>day2</td><td>26</td></tr>
    <tr><td class='row_index'>14</td><td>day2</td><td>23</td></tr>
    <tr><td class='row_index'>15</td><td>day3</td><td>26</td></tr>
    <tr><td class='row_index'>16</td><td>day3</td><td>25</td></tr>
    <tr><td class='row_index'>17</td><td>day3</td><td>24</td></tr>
    <tr><td class='row_index'>18</td><td>day3</td><td>27</td></tr>
    <tr><td class='row_index'>19</td><td>day3</td><td>23</td></tr>
    <tr><td class='row_index'>20</td><td>day4</td><td>23</td></tr>
    <tr><td class='row_index'>21</td><td>day4</td><td>21</td></tr>
    <tr><td class='row_index'>22</td><td>day4</td><td>22</td></tr>
    <tr><td class='row_index'>23</td><td>day4</td><td>26</td></tr>
    <tr><td class='row_index'>24</td><td>day4</td><td>27</td></tr>
    <tr><td class='row_index'>25</td><td>day5</td><td>27</td></tr>
    <tr><td class='row_index'>26</td><td>day5</td><td>26</td></tr>
    <tr><td class='row_index'>27</td><td>day5</td><td>27</td></tr>
    <tr><td class='row_index'>28</td><td>day5</td><td>24</td></tr>
    <tr><td class='row_index'>29</td><td>day5</td><td>28</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>30 rows &times; 2 columns</div>
  </div>
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DT</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;country&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;United States&quot;</span><span class="p">,</span> <span class="s2">&quot;Russia&quot;</span><span class="p">,</span> <span class="s2">&quot;China&quot;</span><span class="p">],</span>
                <span class="s2">&quot;vault_2012_f&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="mf">48.132</span><span class="p">,</span>
                    <span class="mf">46.366</span><span class="p">,</span>
                    <span class="mf">44.266</span><span class="p">,</span>
                <span class="p">],</span>
                <span class="s2">&quot;vault_2012_m&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">46.632</span><span class="p">,</span> <span class="mf">46.866</span><span class="p">,</span> <span class="mf">48.316</span><span class="p">],</span>
                <span class="s2">&quot;vault_2016_f&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="mf">46.866</span><span class="p">,</span>
                    <span class="mf">45.733</span><span class="p">,</span>
                    <span class="mf">44.332</span><span class="p">,</span>
                <span class="p">],</span>
                <span class="s2">&quot;vault_2016_m&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">45.865</span><span class="p">,</span> <span class="mf">46.033</span><span class="p">,</span> <span class="mf">45.0</span><span class="p">],</span>
                <span class="s2">&quot;floor_2012_f&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">45.366</span><span class="p">,</span> <span class="mf">41.599</span><span class="p">,</span> <span class="mf">40.833</span><span class="p">],</span>
                <span class="s2">&quot;floor_2012_m&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">45.266</span><span class="p">,</span> <span class="mf">45.308</span><span class="p">,</span> <span class="mf">45.133</span><span class="p">],</span>
                <span class="s2">&quot;floor_2016_f&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">45.999</span><span class="p">,</span> <span class="mf">42.032</span><span class="p">,</span> <span class="mf">42.066</span><span class="p">],</span>
                <span class="s2">&quot;floor_2016_m&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">43.757</span><span class="p">,</span> <span class="mf">44.766</span><span class="p">,</span> <span class="mf">43.799</span><span class="p">],</span>
            <span class="p">}</span>
        <span class="p">)</span>

<span class="n">DT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div class='datatable'>
  <table class='frame'>
  <thead>
    <tr class='colnames'><td class='row_index'></td><th>country</th><th>vault_2012_f</th><th>vault_2012_m</th><th>vault_2016_f</th><th>vault_2016_m</th><th>floor_2012_f</th><th>floor_2012_m</th><th>floor_2016_f</th><th>floor_2016_m</th></tr>
    <tr class='coltypes'><td class='row_index'></td><td class='str' title='str32'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td><td class='float' title='float64'>&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;&#x25AA;</td></tr>
  </thead>
  <tbody>
    <tr><td class='row_index'>0</td><td>United States</td><td>48.132</td><td>46.632</td><td>46.866</td><td>45.865</td><td>45.366</td><td>45.266</td><td>45.999</td><td>43.757</td></tr>
    <tr><td class='row_index'>1</td><td>Russia</td><td>46.366</td><td>46.866</td><td>45.733</td><td>46.033</td><td>41.599</td><td>45.308</td><td>42.032</td><td>44.766</td></tr>
    <tr><td class='row_index'>2</td><td>China</td><td>44.266</td><td>48.316</td><td>44.332</td><td>45</td><td>40.833</td><td>45.133</td><td>42.066</td><td>43.799</td></tr>
  </tbody>
  </table>
  <div class='footer'>
    <div class='frame_dimensions'>3 rows &times; 9 columns</div>
  </div>
</div>
</div></div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Samuel Oranyeli<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>